from bs4 import BeautifulSoup
from itertools import zip_longest
from datetime import datetime
import requests
import re
import MySQLdb


def firstparam():
    return (max_indb() + 1)


def secondparam():
    return (last_vote() + 1)


def lastparam():
    return (last_vote() - max_indb())


def last_vote():
    poll_page = 'https://www.senate.gov/legislative/votes_new.htm'
    page1 = requests.get(poll_page)
    page = page1.text

    soup = BeautifulSoup(page, 'html.parser')

    last_vote = soup.find(href=re.compile("vote=")).text
    regex = re.compile("(.*?)\s*\(")
    last_vote_out = regex.match(last_vote)
    return (int(last_vote_out.group(1)))


def max_indb():

    db = MySQLdb.connect(
        host=
        "website.cdxegkycqe8x.us-east-2.rds.amazonaws.com",  # host,localhost
        user="alacaria",  # username
        passwd="Sterling",  # password
        db="alacaria")  # name of the data base
    cur = db.cursor()

    result = cur.execute("SELECT max(`vote_number`) FROM vote")
    myresult = cur.fetchall()

    #print(myresult[0])

    int_result = int(myresult[0][0])

    return int_result
